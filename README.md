# Plotting scripts + simulation data (Lichtenberg et al., 2021)

This repository is part of the openly available *Materials & Methods* at https://osf.io/e2kfv/.

# Contact

For questions, help and notifications surrounding this repository please contact [Tim Lichtenberg](https://timlichtenberg.net/) (tim.lichtenberg@physics.ox.ac.uk) and/or [Joanna Dra̧żkowska](https://www.usm.uni-muenchen.de/people/drazkowska/) (joanna.drazkowska@lmu.de).

# References

When you make use of material from this repository, please acknowledge:

> Lichtenberg, T., Dra̧żkowska, J., Schönbächler, M., Golabek, G. J., Hands, T. O. (2021) Bifurcation of planetary building blocks during Solar System formation.

# Repository structure

    .
    ├── /data                           # Simulation data files, top-level directory
    │   ├── /Drazkowska_Dullemond_2018  # Disk and dust coagulation simulation data
    │   ├── /migration                  # Planet orbital migration data
    │   ├── /planetesimal_evolution     # Planetesimal evolution data
    │   │   └── /sfd_data               # Planetesimal population help files
    │   └── /surface_conduction         # External heating effects on planetesimals, code + data
    ├── /figures                        # Manuscript figures, generated by scripts 'fig_().py'
    ├── /illustrations                  # Illustration sources files for Figs. 2b + 6
    ├── fig_().py                       # Plottings scripts to generate figures fig_().pdf in /figures
    ├── ...                       
    ├── jd_natconst.oy                  # Definitions of nature constants
    ├── jd_plot.py                      # Function and package definitions
    ├── jd_readdata.py                  # Data structure definitions to read in the disk simulations
    ├── LICENSE                         # License agreement when using data from this repository
    ├── migration_tracks.py             # Code to calculate planetary orbital migration
    ├── sfd_functions.py                # Function definitions to compute planetesimal populations
    ├── sfd1_gen.py                     # Script to generate planetesimal SFDs
    ├── sfd2_interpolation.py           # Script to create interpolation function
    ├── sfd3_evolution.py               # Script to interpolate planetesimal evolution to SFD
    └── README.md                       # This README file

# Software requirements

Python 3.x

Python 3 package *natsort*: https://pypi.org/project/natsort/

MATLAB 2018 (or later)

# Plots & figures

To re-plot *Figures 1–6* (main text) and *S1–S12* (Supplementary Material), execute the appropriate Python script:

    .
    ├── fig_1.py     
    ├── fig_2.py     
    ├── fig_3.py     
    ├── fig_4.py     
    ├── fig_5.py        
    ├── fig_s1.py     
    ├── fig_s2.py     
    ├── fig_s3.py     
    ├── fig_s4.py     
    ├── fig_s5.py     
    ├── fig_s6.py     
    ├── fig_s7.py     
    ├── fig_s8.py     
    ├── fig_s9.py     
    ├── fig_s10.py     
    ├── fig_11.py     
    ├── fig_12.py                    

All scripts apart from *fig_2.py* and *fig_s11.py* should be directly executable using Python. These two files rely on an external package. To execute them, do the following:

- Download *epsilon.tar.gz* from Dr. Chris Ormel's website at: https://staff.fnwi.uva.nl/c.w.ormel/software.html
- Unzip into the top-level repository folder (*OL18.py* is the required python package file).
- Then execute the two scripts.
- Please contact us if *epsilon.tar.gz* should not be available online anymore.

# Simulation code & data

## Disk evolution & dust coagulation: data

If you make use of any of this data please acknowledge:

> Dra̧żkowska, J., Dullemond, C. P. (2018). Planetesimal formation during protoplanetary disk buildup. Astronomy & Astrophysics, 614, A62.

The respective files and data are in:

    .
    ├── /data                           # Simulation data files, top-level directory
    │   ├── /Drazkowska_Dullemond_2018  # Disk and dust coagulation simulation data
    ├── jd_natconst.oy                  # Definitions of nature constants
    ├── jd_plot.py                      # Function and package definitions
    ├── jd_readdata.py                  # Data structure definitions to read in the disk simulations

How the data is structured is shown in:

    ├── jd_readdata.py                  # Data structure definitions to read in the disk 
    
The following plotting scripts illustrate how to use the data:

    .
    ├── fig_1.py     
    ├── fig_2.py         
    ├── fig_s1.py     
    ├── fig_s2.py     
    ├── fig_s3.py       
    ├── fig_11.py     
    
Further details on the simulation code can be found at: https://github.com/astrojoanna/DD-diskevol.


## Planetesimal evolution: data

The respective files and data are in:

    .
    ├── /data                           # Simulation data files, top-level directory
    │   ├── /planetesimal_evolution     # Planetesimal evolution data
    │   │   └── /sfd_data               # Planetesimal population data

The following plotting scripts illustrate how to use the data:

    .
    ├── fig_3.py     
    ├── fig_4.py         
    ├── fig_5.py     
    ├── fig_s4a.py 
    ├── fig_s4b.py     
    ├── fig_s5a.py   
    ├── fig_s5b.py     
    ├── fig_s6a.py  
    ├── fig_s6b.py    
    ├── fig_s7a.py 
    ├── fig_s7b.py 
    ├── fig_s8.py 

The most important data files are the following:

    .
    ├── /data
    │   ├── r()t()al()fe()tmp().dat     # Single planetesimal evolution, naming scheme: r - radius, al - Al26, fe - Fe60, tmp – starting temp
    │   ├── plts_all_data.csv           # Combines all single-planetesimal in one python dictionary
    │   ├── sfd_evolution.csv           # Evolution of Reservoir I and II in one dictionary, special headers: res - Reservoir I (resI) or II (resII), imf - planetesimal SFD (powerlaw)

The headers for the single planetesimal data files are:
> time,sol_frac,liq_frac,hydrous_frac,primitive_frac,n2co2_frac,cocl_frac,h2o_frac,phyllo1_frac,phyllo2_frac,phyllo3_frac,phyllo4_frac,perco_frac,melt1_frac,melt2_frac,maxtk,t_max_body,meantk,t_mean_body,count_toohot

For example, the temperature evolution is represented by the colum *maxtk*, mean body temperature by *t_mean_body*. Times are in Myr after CAI formation.

The SFD evolution calculations are performed in:

    .
    ├── sfd_functions.py                # Function definitions to compute planetesimal populations
    ├── sfd1_gen.py                     # Script to generate planetesimal SFDs
    ├── sfd2_interpolation.py           # Script to create interpolation function
    ├── sfd3_evolution.py               # Script to interpolate planetesimal evolution to SFD

Further details on the simulation code (for the single planetesimal simulations) can be found at: https://github.com/timlichtenberg/i2elvis_planet.

## Planetary orbital migration: simulation code & data

The data and simulation code files for migration are in:

    .
    ├── /data                           
    │   ├── /migration                  # Planet orbital migration data

The following scripts illustrate how to use the data:

    .
    ├── fig_1.py  
    ├── fig_s9.py        

The script to generate the migration data is in:

    .
    ├── migration_tracks.py             # Code to calculate planetary orbital migration


## External planetesimal heating: simulation code & data

The data files for external heating effects are in:

    .
    ├── /data                           
    │   └── /surface_conduction         # External heating effects on planetesimals, code + data

The following script illustrates how to use the data:

    .
    ├── fig_s10.py        

The script to calculate the external heating effects is in (this requires MATLAB):

    .
    ├── /data                           
    │   └── /thermal_diffusion_1d_radial.m         # External heating code

# License information

The material in this repository is licensed under the [GNU General Public License v3.0](https://github.com/timlichtenberg/2stage_scripts_data/blob/master/LICENSE). Permissions of this license are conditioned on making available complete source code of licensed works and modifications, which include larger works using a licensed work, under the same license.
